<!DOCTYPE html>
<html lang="en">

<head>
	<title>Milky Way Medium - Login</title>
	
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="ie=edge" />
	<meta name="description" content="" />
	<meta name="keywords" content="" />
	
	<!-- Base stylesheet for all pages -->
	<link rel="stylesheet" type="text/css" href="../components/stylesheets/index.css" />
	<link rel="stylesheet" href="../components/stylesheets/checkboxes.css"/>
	
	<!-- Site logo browser icon (.ico) -->
	<link rel="icon" href="../components/images/favicon.ico">
	
</head>



<body>
	<!-- Navigation bar -->
	<div class="navBar">
	
		<!-- Left portion of navigation (logo and site title) -->
		<a href="../">
			<img src="../components/images/animated.gif">
			<div class="navBarInnerLeft"><div id="small">MIL<span style="letter-spacing: 2px;">KY</span><span style="letter-spacing: 1px;"> </span><span style="letter-spacing: -4px;">WAY</span><br></div>MEDIUM</div>
		</a>
		
		<!-- Right portion of navigation (page links) -->
		<div id="navRight" class="navBarInnerRight">
			<a style="opacity: 0.4" id="login" href="../login/">LOGIN</a>
			<a id="register" href="../register">CREATE &nbsp;ACCOUNT</a>
			<a href="../about/">ABOUT</a>
		</div>
		
	</div>
	<br><br><br><br><br><br>
	
	
	<!-- Block feed -->
	<div class="container" id="container">
		<div class="block-content">
			
			<form id="login-form" method="post">

				<!-- Username section -->
				<label for="uname"><b style="color: #020011; font-size: 17px;">Email or Username</b></label>
				<input type="text" placeholder="Enter your email or username..." name="identification" required>
				<br><br>

				<!-- Email address section -->
				<label for="email"><b style="color: #020011; font-size: 17px;">Password</b></label>
				<input type="password" placeholder="Enter your password..." name="password" required>
				<br><br>
				
				<div style="width: 100%; display: inline-block; float: right;">
					<span style="float: left;">
						<input type="checkbox" id="checkbox2" class="css-checkbox" />
						<label for="checkbox2" name="checkbox2_lbl" class="css-label chrome-style" style="color: #020011; margin-top: -4px;">Remember Me</label>
					</span>
					<span style="float: right; margin-top: -3px;">
						<a style="font-size: 15px; color: #B79500;" href="forgot/">I forgot my login information...</a>
					</span>
				</div>
				<br><br>
				
				<!-- Continue creating a new account button -->
				<button id="login-button" class="button-login" style="width: 100%; height: 55px;" type="submit">LOGIN</button>
				<br>
				
			</form>
			
		</div>
	</div>
	
	
	<script type="module">
				  import { initializeApp } from 'https://www.gstatic.com/firebasejs/9.6.7/firebase-app.js'
				  // Add Firebase products that you want to use
				  import { initializeAuth, signInWithEmailAndPassword, signOut, onAuthStateChanged } from 'https://www.gstatic.com/firebasejs/9.6.7/firebase-auth.js'
				  
				  const firebaseConfig = {
				  apiKey: "AIzaSyB4L71q-5qsAD2RbzYkPI8S66t1-gPmLlc",
				  authDomain: "milkywaymedium.firebaseapp.com",
				  databaseURL: "https://milkywaymedium.firebaseio.com",
				  projectId: "milkywaymedium",
				  storageBucket: "milkywaymedium.appspot.com",
				  messagingSenderId: "165659589186",
				  appId: "1:165659589186:web:14f35c3010b2e5600c0bdb",
				  measurementId: "G-WGKXQT89RQ",
				};

				// Initialize Firebase
				const app = initializeApp(firebaseConfig);
				const auth = initializeAuth(app);
				
				console.log(app, auth);
				
				auth.onAuthStateChanged((user) => {
						if(user) {
							console.log('User logged in: ', user);
							const navRight = document.getElementById('navRight');
							navRight.innerHTML = `<a id="logout" href=".">LOGOUT</a><a href="../about/">ABOUT</a>`;
							// Logout
							const logout = document.getElementById("logout");
							logout.addEventListener('click', (e) => {
								e.preventDefault();
								console.log('User logged out');
								signOut(auth).then();
							});
						}
						else {
							console.log('User not logged in');
						}
				});
				
				
				const loginForm = document.querySelector('#login-form');
				const loginButton = document.getElementById("login-button");
				var identification = "";
				var password ="";
				
				// Login
				loginForm.addEventListener('submit', (e) => {
					console.log(1);
					e.preventDefault();
					var identification = loginForm['identification'].value;
					var password = loginForm['password'].value;
					var loggedIn = false;
					console.log(2);
					
					
					signInWithEmailAndPassword(auth, identification, password).then(cred => {
						identification = "";
						password = "";
						loggedIn = true;
						console.log(3);
						console.log(cred.user);
					});
					
					if(loggedIn) {
						//location.href = 'https://milkywaymedium.com/';
						console.log(4);
					}
					
					console.log(5);
		
				});
					
			</script>
	
	
</body>

</html>


